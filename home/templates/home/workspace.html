{% extends "home/layouts/layout-fixed-side-bar.html" %}
{% load static %}

{% block title %}
    OneTable - {{ app.name }}
{% endblock %}

{% block headername %}
  {{ app.name }}
{% endblock %}

{% block headerlink %}
  {% url 'apps' organization_pk=organization.pk %}
{% endblock %}

{% block header %}
  {% include 'home/layouts/component-header-workspace.html' %}
{% endblock %}

{% block bodyclass %}
class="bg-white"
{% endblock %}

{% block sidebar %}
  {% include 'home/layouts/component-sidebar-workspace.html' %}
{% endblock %}

{% block content %}

  {% if type == 'dashboard' %}
    {% include 'home/dashboard.html' %}
  {% elif type == 'tasks' %}
    {% include 'home/tasks.html' %}
  {% elif type == 'notes' %}
    {% include 'home/notes.html' %}
  {% elif type == 'lists' %}
    {% include 'home/lists.html' %}
  {% elif type == 'list-create' %}
    {% include 'home/list-create.html' %}
  {% elif type == 'edit-list' %}
    {% include 'home/list-create.html' %}
  {% elif type == 'list' %}
    {% include 'home/list.html' %}
  {% elif type == 'add-record' %}
    {% include 'home/record-create.html' %}
  {% elif type == 'record-details' %}
    {% include 'home/record-details.html' %}
  {% elif type == 'edit-record' %}
    {% include 'home/record-create.html' %}
  {% else %}
    {# Load default dashboard #}
    {% include 'home/dashboard.html' %}
  {% endif %}

{% endblock %}

<!-- Include JS here that does not need template tags -->

<!-- Include JS here that needs template tags -->
{% block extrajs %}
<script>

  function showDashboard() {
    const url = "{% url 'dashboard' organization_pk=organization.pk app_pk=app.pk %}";
    $.ajax({
        type: "GET",
        url: url,
        data: {
            'csrfmiddlewaretoken': window.CSRF_TOKEN // from index.html
        },
        success: function(data) {
            // append html to the posts div
            $('#main-content').html(data['html_from_view']);
        },
        error: function(xhr, status, error) {
            // shit happens friends!
        }
    }).always(()=> {

      window.history.pushState({}, '', url);
    });
  }

  function showTasks() {
    const url = "{% url 'tasks' organization_pk=organization.pk app_pk=app.pk %}";
    $.ajax({
      type: "GET",
      url: url,
        data: {
            'csrfmiddlewaretoken': window.CSRF_TOKEN // from index.html
        },
        success: function(data) {
            // append html to the posts div
            $('#main-content').html(data['html_from_view']);
        },
        error: function(xhr, status, error) {
            // shit happens friends!
        }
    }).always(() => {

      window.history.pushState({}, '', url);
    });
  }

  function showNotes() {
    const url = "{% url 'notes' organization_pk=organization.pk app_pk=app.pk %}";
    $.ajax({
      type: "GET",
      url: url,
        data: {
            'csrfmiddlewaretoken': window.CSRF_TOKEN // from index.html
        },
        success: function(data) {
            // append html to the posts div
            $('#main-content').html(data['html_from_view']);
        },
        error: function(xhr, status, error) {
            // shit happens friends!
        }
    }).always(() => {

      window.history.pushState({}, '', url);
    });
  }

  function showLists() {
    const url = "{% url 'lists' organization_pk=organization.pk app_pk=app.pk %}";
    $.ajax({
      type: "GET",
      url: url,
        data: {
            'csrfmiddlewaretoken': window.CSRF_TOKEN // from index.html
        },
        success: function(data) {
            // append html to the posts div
            $('#main-content').html(data['html_from_view']);
        },
        error: function(xhr, status, error) {
            // shit happens friends!
        }
    }).always(() => {

      window.history.pushState({}, '', url);
    });
  }

  {% if list %}
  function showRecords() {
    const url = "{% url 'list' organization_pk=organization.pk app_pk=app.pk list_pk=list.pk %}";
    $.ajax({
      type: "GET",
      url: url,
        data: {
            'csrfmiddlewaretoken': window.CSRF_TOKEN // from index.html
        },
        success: function(data) {
            // append html to the posts div
            $('#main-content').html(data['html_from_view']);
        },
        error: function(xhr, status, error) {
            // shit happens friends!
        }
    }).always(() => {

      window.history.pushState({}, '', url);

    });
  }
  {% endif %}

</script>
{% endblock %}
